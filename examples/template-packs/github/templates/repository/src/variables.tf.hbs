# Basic Settings
variable "repository_name" {
  type        = string
  description = "Repository name (must be unique within your organization/account)"
  default     = "{{repository_name}}"

  validation {
    condition     = can(regex("^[a-zA-Z0-9._-]+$", var.repository_name))
    error_message = "Repository name must only contain alphanumeric characters, hyphens, underscores, and periods."
  }
}

variable "description" {
  type        = string
  description = "Repository description"
  default     = "{{description}}"
}

variable "visibility" {
  type        = string
  description = "Repository visibility level"
  default     = "{{visibility}}"

  validation {
    condition     = contains(["public", "private", "internal"], var.visibility)
    error_message = "Visibility must be public, private, or internal."
  }
}

variable "homepage_url" {
  type        = string
  description = "Repository homepage URL"
  default     = "{{homepage_url}}"
}

# Repository Features
variable "has_issues" {
  type        = bool
  description = "Enable issues for this repository"
  default     = {{bool has_issues}}
}

variable "has_wiki" {
  type        = bool
  description = "Enable wiki for this repository"
  default     = {{bool has_wiki}}
}

variable "has_projects" {
  type        = bool
  description = "Enable projects for this repository"
  default     = {{bool has_projects}}
}

variable "has_discussions" {
  type        = bool
  description = "Enable discussions for this repository"
  default     = {{bool has_discussions}}
}

variable "has_downloads" {
  type        = bool
  description = "Enable downloads feature for this repository"
  default     = {{bool has_downloads}}
}

# Initialization Options
variable "auto_init" {
  type        = bool
  description = "Initialize repository with README file"
  default     = {{bool auto_init}}
}

variable "gitignore_template" {
  type        = string
  description = ".gitignore template to use"
  default     = "{{gitignore_template}}"
}

variable "license_template" {
  type        = string
  description = "License template to use"
  default     = "{{license_template}}"
}

variable "default_branch" {
  type        = string
  description = "Default branch name"
  default     = "{{default_branch}}"
}

# Merge Settings
variable "allow_merge_commit" {
  type        = bool
  description = "Allow merge commits"
  default     = {{bool allow_merge_commit}}
}

variable "allow_squash_merge" {
  type        = bool
  description = "Allow squash merging"
  default     = {{bool allow_squash_merge}}
}

variable "allow_rebase_merge" {
  type        = bool
  description = "Allow rebase merging"
  default     = {{bool allow_rebase_merge}}
}

variable "allow_auto_merge" {
  type        = bool
  description = "Allow auto-merge on pull requests"
  default     = {{bool allow_auto_merge}}
}

variable "delete_branch_on_merge" {
  type        = bool
  description = "Automatically delete head branches after pull requests are merged"
  default     = {{bool delete_branch_on_merge}}
}

# Topics and Metadata
variable "topics" {
  type        = string
  description = "Repository topics (comma-separated, lowercase, use hyphens)"
  default     = "{{topics}}"
}

variable "is_template" {
  type        = bool
  description = "Mark this repository as a template repository"
  default     = {{bool is_template}}
}

variable "archived" {
  type        = bool
  description = "Archive this repository (read-only)"
  default     = {{bool archived}}
}

# Security Settings
variable "vulnerability_alerts" {
  type        = bool
  description = "Enable security vulnerability alerts"
  default     = {{bool vulnerability_alerts}}
}

# Branch Protection
variable "enable_branch_protection" {
  type        = bool
  description = "Enable branch protection rules for the default branch"
  default     = {{bool enable_branch_protection}}
}

variable "require_pull_request_reviews" {
  type        = bool
  description = "Require pull request reviews before merging"
  default     = {{bool require_pull_request_reviews}}
}

variable "required_approving_review_count" {
  type        = number
  description = "Number of required approving reviews"
  default     = {{required_approving_review_count}}

  validation {
    condition     = var.required_approving_review_count >= 0 && var.required_approving_review_count <= 6
    error_message = "Required approving review count must be between 0 and 6."
  }
}

variable "require_code_owner_reviews" {
  type        = bool
  description = "Require review from code owners"
  default     = {{bool require_code_owner_reviews}}
}

variable "dismiss_stale_reviews" {
  type        = bool
  description = "Dismiss stale pull request reviews when new commits are pushed"
  default     = {{bool dismiss_stale_reviews}}
}

variable "require_status_checks" {
  type        = bool
  description = "Require status checks to pass before merging"
  default     = {{bool require_status_checks}}
}

variable "status_check_contexts" {
  type        = string
  description = "Required status check contexts (comma-separated)"
  default     = "{{status_check_contexts}}"
}

variable "enforce_admins" {
  type        = bool
  description = "Enforce branch protection rules for administrators"
  default     = {{bool enforce_admins}}
}

variable "require_signed_commits" {
  type        = bool
  description = "Require signed commits"
  default     = {{bool require_signed_commits}}
}

variable "require_linear_history" {
  type        = bool
  description = "Require linear history (no merge commits)"
  default     = {{bool require_linear_history}}
}

# Access Management
variable "enable_team_access" {
  type        = bool
  description = "Enable team-based access management"
  default     = {{bool enable_team_access}}
}

variable "teams" {
  type        = string
  description = "Team access configuration (format: team-name:permission,another-team:permission)"
  default     = "{{teams}}"
}

variable "enable_collaborator_access" {
  type        = bool
  description = "Enable individual collaborator access management"
  default     = {{bool enable_collaborator_access}}
}

variable "collaborators" {
  type        = string
  description = "Collaborator access configuration (format: username:permission,another-user:permission)"
  default     = "{{collaborators}}"
}
