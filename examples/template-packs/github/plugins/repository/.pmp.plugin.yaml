apiVersion: pmp.io/v1
kind: Plugin
metadata:
  name: repository
  description: Create a GitHub repository for your application with opinionated defaults

spec:
  role: source-control

  inputs:
    # Project Metadata
    project_name:
      type: string
      description: Repository name (defaults to project name)
      default: ""

    project_description:
      type: string
      description: Repository description (defaults to project description)
      default: ""

    # Basic Settings
    visibility:
      type: select
      options:
        - label: "Public (Anyone can see)"
          value: "public"
        - label: "Private (Only you and collaborators)"
          value: "private"
        - label: "Internal (Organization members only)"
          value: "internal"
      default: "private"
      description: Repository visibility level

    # Repository Features
    has_issues:
      type: boolean
      description: Enable issues for this repository
      default: true

    has_wiki:
      type: boolean
      description: Enable wiki for this repository
      default: false

    has_projects:
      type: boolean
      description: Enable projects for this repository
      default: false

    # Initialization
    gitignore_template:
      type: select
      options:
        - label: "None"
          value: ""
        - label: "Node.js"
          value: "Node"
        - label: "Python"
          value: "Python"
        - label: "Go"
          value: "Go"
        - label: "Rust"
          value: "Rust"
        - label: "Java"
          value: "Java"
        - label: "Ruby"
          value: "Ruby"
        - label: "Terraform"
          value: "Terraform"
      default: ""
      description: .gitignore template to use

    license_template:
      type: select
      options:
        - label: "None"
          value: ""
        - label: "MIT License"
          value: "mit"
        - label: "Apache License 2.0"
          value: "apache-2.0"
        - label: "GNU GPL v3.0"
          value: "gpl-3.0"
        - label: "BSD 3-Clause License"
          value: "bsd-3-clause"
      default: "mit"
      description: License template to use

    default_branch:
      type: string
      description: Default branch name
      default: "main"

    # Merge Settings
    delete_branch_on_merge:
      type: boolean
      description: Automatically delete head branches after pull requests are merged
      default: true

    # Branch Protection
    enable_branch_protection:
      type: boolean
      description: Enable branch protection rules for the default branch
      default: true

    required_approving_review_count:
      type: select
      options:
        - label: "1 Approval"
          value: "1"
        - label: "2 Approvals"
          value: "2"
        - label: "3 Approvals"
          value: "3"
      default: "1"
      description: Number of required approving reviews

    # Access Management
    enable_team_access:
      type: boolean
      description: Enable team-based access management
      default: false

    teams:
      type: string
      description: Team access configuration (format - team-name:permission,another-team:permission)
      default: ""
