{{#if (eq enable_team_access "true")}}
{{#if teams}}
# Team access management
locals {
  team_access = {
    for entry in split(",", var.teams) :
    split(":", trimspace(entry))[0] => split(":", trimspace(entry))[1]
    if trimspace(entry) != "" && length(split(":", trimspace(entry))) == 2
  }
}

resource "github_team_repository" "plugin_team_access" {
  for_each = local.team_access

  team_id    = each.key
  repository = github_repository.plugin_repo.name
  permission = each.value

  depends_on = [github_repository.plugin_repo]
}
{{/if}}
{{/if}}
