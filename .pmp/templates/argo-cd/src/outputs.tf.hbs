output "namespace" {
  description = "Namespace where Argo CD is installed"
  value       = var.namespace
}

output "release_name" {
  description = "Helm release name"
  value       = helm_release.argocd.name
}

output "chart_version" {
  description = "Argo CD Helm chart version"
  value       = helm_release.argocd.version
}

output "server_replicas" {
  description = "Number of Argo CD server replicas"
  value       = var.server_replicas
}

{{#if enable_ingress}}
output "server_url" {
  description = "Argo CD server URL"
  value       = var.server_host != "" ? "https://${var.server_host}" : "Ingress enabled but no hostname configured"
}
{{else}}
output "access_instructions" {
  description = "Instructions for accessing Argo CD"
  value       = <<-EOT
    Argo CD is installed but ingress is disabled.

    To access Argo CD, run:
    kubectl port-forward svc/argocd-server -n ${var.namespace} 8080:443

    Then access: https://localhost:8080

    Default username: admin
    To get the initial password, run:
    kubectl get secret argocd-initial-admin-secret -n ${var.namespace} -o jsonpath="{.data.password}" | base64 -d
  EOT
}
{{/if}}

{{#if ha_enabled}}
output "ha_mode" {
  description = "High availability mode status"
  value       = "enabled"
}
{{/if}}

output "installation_notes" {
  description = "Important notes about the Argo CD installation"
  value       = <<-EOT
    Argo CD has been successfully installed in the '${var.namespace}' namespace.

    Chart version: ${var.chart_version}
    Server replicas: ${var.server_replicas}
    Repo-server replicas: ${var.repo_server_replicas}
{{#if ha_enabled}}
    High Availability: enabled
{{/if}}

    For more information, visit: https://argo-cd.readthedocs.io/
  EOT
}
